---
title: "Hauser_Tests"
author: "Emma Hauser"
params:
  today: !r.Sys.Date
#bibliography: HW2_Refs.bib
output: html_document
---
##Tests for data_import function

```{r Data_Import_sourced, echo=T}
source("Data_Import_Function.R")
```

###Test if data_import makes a data.frame object
```{r DataImport_Test, echo=TRUE}
test <- data_import("NameOfCSV", "PDFData")
if(typeof(test) == data.frame)
{
  print("passed")
}else
{
  print("failed")
}
```

###Test that data_import makes dataframe of correct dimensions

```{r DataImport_Test_2, echo=TRUE}
ExpectRows <- 42
ExpectCols <- 16
test <- data_import("NameOfCSV", "PDFData")
if(ncol(test) == ExpectCols && nrow(test) == ExpectRows)
{
  print("passed")
}else
{
  print("failed")
}
```


##Tests for soil_stats function

```{r soil_stats_sourced, echo=T}
source("Soil_Stats_function.R")
```

###Test that soil_stats makes dataframe of correct dimensions
```{r soil_stats_1, echo=TRUE}
ExpectRowsSoil <- 12
ExpectColsSoil <- 5
testStats <- soil_stats(test)
if(ncol(testStats) == ExpectColsSoil && nrow(testStats) == ExpectRowsSoil)
{
  print("passed")
}else
{
  print("failed")
}
```

###Test that soil_stats calculates means correctly

```{r soil_stats_2, echo=TRUE}
ExpectMean <- 4.713 #this is the first mean, which should be in the first column of response variables, column 3, row 1
testStats2 <- soil_stats(test)
if(testStats2[1,3]==ExpectMean)
{
  print("passed")
}else
{
  print("failed")
}
```

###Test that soil_stats calculates realistic correlation value

```{r soil_stats_3, echo=TRUE}
correlRangeMin <- -1
correlRangeMax <- 1
testStats3 <- soil_stats(test)
if(testStats3[,5] > correlRangeMin && testStats3[,5] < correlRangeMax)
{
  print("passed")
}else
{
  print("failed")
}
```


##Tests for soil_plot function

```{r Soil_plot_sourced, echo=T}
source("SoilDataPlottingFunction.R")
install.packages("testthat")
library(testthat) #This test will make use of the testthat package and function, which is used for examining plot elements and expectations, particularly for graphs produced in ggplot2 
```


###Test that soil_plot function returns a ggplot object

```{r soil_plot_1, echo=TRUE}
testplot <- soil_plot(test)

#test_that("Plot returns ggplot object",
#{
#Passes
  #expect_is(testplot,"ggplot")
#})

#The testthat() function returns red numbered "Failure" messages with description of the problem when expectation is not met. If the test passes, the function displays a green dot. 
#Resource for this function: https://journal.r-project.org/archive/2011/RJ-2011-002/RJ-2011-002.pdf
```


###Test that soil_plot function uses correct data

```{r soil_plot_2, echo=TRUE}
testplot2 <- soil_plot(test)

#test_that("Plot uses correct data", 
#{
  #Passes
  #expect_that(testplot2, equals(test$responseData))
#})

```